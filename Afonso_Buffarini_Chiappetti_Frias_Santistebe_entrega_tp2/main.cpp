// Afonso Gaston
// Buffarini Nicolas
// Chiappetti Pablo
// Frias Magali
// Santistebe Mateo


#include <iostream>
#include <string>
#include <vector>
#include <cstdlib>
#include <ctime>
#include <ncurses.h>

#include "Personaje.h"
#include "funciones.h"

using namespace std;

void jugarAventura();
bool iniciarBatalla();
void mostrarLog(const vector<string> &log);

int main() {
    srand(time(0));
    initscr();
    cbreak();
    noecho();
    keypad(stdscr, TRUE);
    curs_set(0);

    if (has_colors() == TRUE) {
        start_color();
        init_pair(1, COLOR_GREEN, COLOR_BLACK);
    }
    attron(COLOR_PAIR(1));

    bool jugando = true;

    while (jugando) {
        mostrarMenuPrincipal();
        
        char ch;
        int opcion = 0;
        while( (ch = getch()) ) {
            if (ch >= '1' && ch <= '4') {
                opcion = ch - '0';
                break;
            }
        }

        switch (opcion) {
            case 1: jugarAventura(); break;
            case 2: mostrarOpciones(); break;
            case 3: mostrarCreditos(); break;
            case 4: jugando = false; break;
        }
    }

    attroff(COLOR_PAIR(1));
    endwin();
    cout << "Gracias por jugar!" << endl;
    return 0;
}

void jugarAventura() {
    
    limpiarYDibujarMarco();
    mvprintw(2, 20, "                                  _--_-_--_-_--_");
    mvprintw(3, 20, "                              _--_-_--_-_--_-_--_-_");
    mvprintw(4, 20, "                          _--_-_--_-_--_-_--_-_--_-_--");
    mvprintw(5, 20, "                      _--_-_--_-_--_@%%#*#@#+:-=%%*=:-==--");
    mvprintw(6, 20, "                  _--_-_--_-_--_@+*#+%%@%%=*@-.:*#--==+=**-=%%--");
    mvprintw(7, 20, "               _--_-_--_-_--_@*%%%%#*+*#%%#*#**:.:---::-===+=--_-_");
    mvprintw(8, 20, "             _-_--_-_--_-_@#+*%%#%%%%#**%%%%*=+##**%%%%-:-=--::--=+++++--");
    mvprintw(9, 20, "           _-_--_-_--_-_@*=@@%%%@%%%%%##**+***++-...-====++=-::-+@--_-");
    mvprintw(10, 20, "         _-_--_-_--_@%%#%%%%@@@%@%%%%%%##*#*****##*++=+++====++==-::--%%@-_--");
    mvprintw(11, 20, "       _-_--_-_--_@%%#@%%%@@@%%#*++**##%%%%*==*##*=++=-:-==*+=:=-+@--_-_");
    mvprintw(12, 20, "      _-_--_-_--@%%##@@@@@@%%##%%*+==-:=%%*++#*=:::-------++++:=@-_--");
    mvprintw(13, 20, "      -_--_-_--@%%*+#@@@@@@#%%%%%%*%%%%*=+*=-+*%%#*==----+===:===+=.*@-_");
    mvprintw(14, 20, "       -_--_-_--@#%%@@@@@@@%%*#%%@%%#****#*+**+=++***===++*++##=@-_");
    mvprintw(15, 20, "        -_--_-_--@#%%@@@%%@%%%###%%##*##%%%###+==+****=-==+**#@#");
    mvprintw(16, 20, "          -_--_-_--%%##%@@@@@%%%%%#%%%%%@@%%**+**++**=+*####%%#+%%");
    mvprintw(17, 20, "            -_--_-_--*#@@@@@%%%##%%%%%%%#**#####*%%@%%#++*#%%@");
    mvprintw(18, 20, "             -_--_-_--_@%%@@@%%%%###******+++++=-_-_");
    mvprintw(19, 20, "               -_--_-_--_@%%@@@@@%%%%#########**#%%");
    mvprintw(20, 20, "                 -_--_-_--_@%%@@@@@%%%%%#%%%%@%%##%%@%%*--");
    mvprintw(21, 20, "                   -_--_-_--@%%%@%%@@@%%@@@%%%@@#+");
    mvprintw(22, 20, "                     -_--_-_--@@@@@@@@@@@@@%%#**");
    mvprintw(26, 19, "Tu letargo ha terminado. La quietud de tu mundo es interrumpida por el estruendo de un");
    mvprintw(27, 21, "cascarón metálico que desgarra el cielo y se estrella contra la superficie.");
    mvprintw(28, 18, "El calor de nuevas presas aviva tu instinto. Nuevas oportunidades para expandir la colmena.");
    esperarEnter(33);

    limpiarYDibujarMarco();
    mvprintw(2, 20, ".         ... . ..        . . .     .........         .. . . . ......     ....... . .       ....      .");
    mvprintw(3, 20, "");
    mvprintw(4, 20, "                   .      ..:.");
    mvprintw(5, 20, "                   .    ..=*#=.");
    mvprintw(6, 20, "                   .  ....-@@@=.                                       ...");
    mvprintw(7, 20, "                   .  ..+@@@@@#:               ....                   :-...");
    mvprintw(8, 20, "                   . .#%%*=-@@@@@@@#@@#.    ..-=:                       ..");
    mvprintw(9, 20, "                   . ...:-. .-@@@@@@@@@:  .:@%%-.      ...           ...--++-              ...");
    mvprintw(10, 20, "                   .          .:@@@@@@@@@=:.%%@@@#.   .:..           ..-#@@@+:.:..        ....");
    mvprintw(11, 20, "                   .            .%%@@@@@@@@@@@@@@@@@- .=:            ..-@@@+%%%%=:#.=..     ..-.");
    mvprintw(12, 20, "                   .             .=@@@@@@@@@@@@@@@@@-+:.           ..*@@@@@@@@@%%%%#*.      .+");
    mvprintw(13, 20, "                   .               -@@@@@#@@@@@@@@@@@%%:             ..@%%@=+@@@@@%%*#*%%:   :*");
    mvprintw(14, 20, "                   .                -%%@+%%#=@@@@@@#.-...                  ...*-..+@@@+..=@+*#");
    mvprintw(15, 20, "                   .                  .==-+@+@@@@@%%.                           .@-:@@@@@@@@@@@+-. ");
    mvprintw(16, 20, "                   .                 . *-.:#@=+@%%+#@:.                 ..:++==##@.+@@@@@@@@@@@#");
    mvprintw(17, 20, "                   . ................:.:.:...*=*@@@@@@@%%:.             ........+@@@@@@@@@@@@@@@@@");
    mvprintw(18, 20, "                   . ..:*%%#==-::-:..::.:.*@@@#@@@@@@@%%=.      ..       ..::  ..=@@@@@@#@@@@@@@@@@");
    mvprintw(19, 20, "                   . ..-@@@@@##@+.-.-.:. =@@@@@%%@@@@@.      .-.       ..-=  ..%%@@@@@@@@@@@@@@@@@#");
    mvprintw(20, 20, "                   . ..#@@@@@@@@@+:-:.- ..:+@@@@@@@@*..+%%:.         ...++ ..=.@@@@@@@@@@@@@@@@@@@@");
    mvprintw(21, 20, "                   . @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*%%++%%@@@%%*+%%@#+#@@@+-#%%@%%@@@@@@@@@@@@@@@@@@@@@@");
    mvprintw(22, 20, "                   . @@@%%##-==*%%@%%%%##*#%%##**++*#%%#++%%%%@%%##%%@@@@@@@@@@@@@%%@%%##*%%%%@@@@@@@@@@@@#%%@@");
    mvprintw(23, 20, "                   . @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
    mvprintw(26, 26, "Una de las criaturas bípedas, torpe y ruidosa, se acerca a tus huevos.");
    mvprintw(27, 31, "El calor que emana es una invitación. Es el momento perfecto.");
    mvprintw(28, 21, "Con un salto silencioso, te aferras a su rostro, implantando la semilla de una nueva era.");
    mvprintw(29, 35, "Su lucha es breve. El anfitrión perfecto está asegurado.");
    esperarEnter(33);

    limpiarYDibujarMarco();
    mvprintw(2, 20, "                      .::--==*####################*==--::.");
    mvprintw(3, 20, "                  .::--==*##############################*==--::.");
    mvprintw(4, 20, "               .::--==*####***++=--::..::--=++***####*==--::.");
    mvprintw(5, 20, "             .--==*###*+=--:.                  .:--=+*###*==--.");
    mvprintw(6, 20, "           .--==*##*+--.                          .--+*##*==--.");
    mvprintw(7, 20, "         .-*###*-.                                    .-*###*-.");
    mvprintw(8, 20, "        -*##*-.                                          .-*##*-.");
    mvprintw(9, 20, "       -*##*-.                                            .-*##*-.");
    mvprintw(10, 20, "     -*##*-.          .::--==*####*++=--::..::--=+*####*==--::..-*##*-.");
    mvprintw(11, 20, "    -*##*-.       .--==*###*+=--:.                  .:--=+*###*==--.-*##*-.");
    mvprintw(12, 20, "   -*##*-.      .--==*##*+--.                          .--+*##*==--.  .-*##*-.");
    mvprintw(13, 20, "  -*##*-.     .--*##*+-.                                .-+*##*--.    .-*##*-.");
    mvprintw(14, 20, " -*##+..    .-*###*-.                                    .-*###*-.    ..+##*-.");
    mvprintw(15, 20, "-*##+-..    -*###+..                                      ..+###*-.    ..-+##*-.");
    mvprintw(16, 20, "-*##*--..   -*##*-.                                          .-*##*-.   ..-*##*-.");
    mvprintw(17, 20, "-*###*----..-*##*-.                                            .-*##*-. ..----*###*-.");
    mvprintw(18, 20, "-*####*+=---*##*-.         ...::--==++**##*==--::...           .-*##*----=+*####*-.");
    mvprintw(19, 20, "-*######*++*##*-.     .::--==*####*++=--::..::--=+*####*==--::. .-*##*++*######*-.");
    mvprintw(20, 20, "-*#########*##*-.   .--==*###*+=--:.                  .:--=+*###*==--.  .-*##*#########*-.");
    mvprintw(21, 20, "-################*#*--*###*-.                                  .-*###*--*#*################-.");
    mvprintw(22, 20, "-#################*##-*####*-.                              .-*####*-##*#################-.");
    mvprintw(23, 20, "-################*#*--*###*-.                              .-*###*--*#*################-.");
    mvprintw(26, 19, "Viajas dentro de tu anfitrión, en el corazón de su nave. Sientes el frío del metal,");
    mvprintw(27, 19, "los murmullos de sus compañeros, la vibración de la maquinaria. El momento de nacer se acerca...");
    esperarEnter(33);
    
    limpiarYDibujarMarco();
    mvprintw(2, 20, "                                        @@%%%%%%%#######%%@@");
    mvprintw(3, 20, "                                      @@%%%%############%%%%@@");
    mvprintw(4, 20, "                                    @%%%%##################%%%%@");
    mvprintw(5, 20, "                                   @%%%%####################%%%%@");
    mvprintw(6, 20, "                                  %%%%#########@@@@@@@@@#####%%%%");
    mvprintw(7, 20, "                                  %%%%########@VVVVVVVVV@####%%%%");
    mvprintw(8, 20, "                                  %%%%########@VVVVVVVVV@####%%%%");
    mvprintw(9, 20, "                                  %%%%#########@@@@@@@@@#####%%%%");
    mvprintw(10, 20, "                                  %%%%#######################%%%%");
    mvprintw(11, 20, "                                  %%%%#########/\\/\\/\\#########%%%");
    mvprintw(12, 20, "                                  %%%%########==|||||==########%%");
    mvprintw(13, 20, "                                  %%%%#######===|||||===#######%%");
    mvprintw(14, 20, "                                  %%%%######====|||||====######%%");
    mvprintw(15, 20, "                                  %%%%#####=====|||||=====#####%%");
    mvprintw(16, 20, "                                  @%%%####======|||||======####%@");
    mvprintw(17, 20, "                                   @%%%###=======|||||=======###@@");
    mvprintw(18, 20, "                                    @@%%##========|||||========##@@");
    mvprintw(19, 20, "                                     @@%%=======|||||||=======%%@@");
    mvprintw(20, 20, "                                       @@%%%%%%%%%%%%%%%%%%%%%@@");
    mvprintw(21, 20, "                                          @@@@@@@@@@@@@@@@@@@");
    mvprintw(26, 24, "¡Nacimiento! Erompes violentamente del pecho de tu huésped. Eres pequeño, vulnerable,");
    mvprintw(27, 23, "pero perfecto. Las otras criaturas gritan, aterrorizadas. Debes esconderte, crecer, adaptarte.");
    esperarEnter(33);

    limpiarYDibujarMarco();
    mvprintw(2, 20, "                                  ...:-+**=:...");
    mvprintw(3, 20, "                                                       ..+######*##+=:...");
    mvprintw(4, 20, "                                                        .%%#%%%%%%#%##*#+..");
    mvprintw(5, 20, "                                     ....                  ..#@@@@@##%%%####**.");
    mvprintw(6, 20, "                               ..-+..                  .:%%@##%%==*++@@%%%%**...");
    mvprintw(7, 20, "                                  ..+%%%==+*+:::--+%%@%%%#:.");
    mvprintw(8, 20, "                               ..+@%%%+#==###%%%%*:.. ..+%%@@@%%+---====+#%%@@%%=.");
    mvprintw(9, 20, "                                 .=@@@@@--:-==+:.:+%%@@@@@@%%#+%%%%##**#%%@@@%%@@#..");
    mvprintw(10, 20, "                                   .+#%%##*#-..-#%%*%%#+++%%#+--+%%@@%%%%@%%%%@%...");
    mvprintw(11, 20, "                                   .+%%%+==+=:+#%%%%#%%+++%%#=-@@@@@@#-.....");
    mvprintw(12, 20, "                                   :#%%%%%%#==+-+=#%##%%%%%%+++*%%+-====#+=..");
    mvprintw(13, 20, "                                   ..%%%%=++#+##*%%#%%%%%%++++:--:=+:.");
    mvprintw(14, 20, "                                  .%%@@@#+#+==+-#@@%%%%%%%%%%#+*#-=-::+-.........");
    mvprintw(15, 20, "                                  .+@@@-=+%%%%#+-==-#%%#####%%%#+#==--**=-:::::::...");
    mvprintw(16, 20, "                                 ..:#@@+===-+####+=-%%%######*#+:-+**%%%%%##-:+##=:..");
    mvprintw(17, 20, "                                 ..#%%@*+-:::-=%%###+%%@%####%%##+:+++%%%%+%%@@%%*=-===-..");
    mvprintw(18, 20, "                                 .%%#%%%%#+-:::--.=%%%%%#%@%%%#*###+-*=#%%+#**+=:...");
    mvprintw(19, 20, "                                 ..%%%%#%%%%=::::+....+%%%@@%%%%%%##%%#++=+=-+##%%%%#=.");
    mvprintw(20, 20, "                                ..#*#+-::::..    ..=##+#%%%%##*%%#*+--+-----.");
    mvprintw(21, 20, "                                .:##*#=-::::..  ..:*#+%%#*#####@%%+-+*+:-=--....");
    mvprintw(22, 20, "                                ..@%%%=+=-:-:.. ..:+#+###%%%%%%%##*=-::::-=-......");
    mvprintw(23, 20, "                                                  ..=+*##########%%%#++*#=-:=##**#:.");
    mvprintw(26, 22, "Los conductos de ventilación se convierten en tu reino. Un laberinto de sombras y metal");
    mvprintw(27, 24, "donde eres el depredador perfecto. Has crecido, tu exoesqueleto endurecido y letal.");
    mvprintw(28, 21, "La tripulación, uno por uno, se convierte en presa. Sus gritos son música en la oscuridad.");
    mvprintw(29, 38, "Brett, Dallas, Parker... todos caen ante ti.");
    esperarEnter(33);

    limpiarYDibujarMarco();
    mvprintw(2, 20, "%%%%%%%%%%%%%%%%%%#########*##########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%");
    mvprintw(3, 20, "%%%%%%%%%%%##%##%%%%###*######*****++***++++#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%");
    mvprintw(4, 20, "%%%%%%%%%%%%%#*##%%####***####*****++***===-:-#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%");
    mvprintw(5, 20, "%%%%%%%%%%%%%############*##******+**++===------#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%");
    mvprintw(6, 20, "%%%%%%%%%%%%%%%%#####**********++*++=====---::*#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%");
    mvprintw(7, 20, "%%%%%%%%%%%%%##########*******+++++=====---::-*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%");
    mvprintw(8, 20, "%%%%%%%%%%%%%%########******++++=++=====--+*#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%");
    mvprintw(9, 20, "##%%%%%%%%%%%%#####*#####*********++==+++++*###%%%%%%%%%%%%%%%%%%#+=+##%%%%%%%%%");
    mvprintw(10, 20, "###%%%%%%%%%%#*+++************=+**+++*###%%%%%######%%%%%#%%%#**#####%%#**#%%%%%%");
    mvprintw(11, 20, "#**#%%%%%%%%%#*+++*###*++++++=+*######*****#%%#####%%%%#*#####+***####%++**##%%%%%");
    mvprintw(12, 20, "#***%%%%%%%%%*+*#######*++===+####%#+======#*#######%%%+=+++*##++++*##%#*###%#%%%%");
    mvprintw(13, 20, "***#%%%%%%%%%#*#########*==--+#%%%%#+=----=#**######%%%=-==++*##++**##%%##%%%%%%%%");
    mvprintw(14, 20, "*+*%%%%%%%%%%#*##########=--=*%%%%%%*=----*%+*######%%%*---=+*#%###%%###%%%%%%%%%%");
    mvprintw(15, 20, "++%%%%%%%%%%%###########+=+#%%%%%%%%#***#%%+**#####%%%%%*+++*#%#*#%%%%%%%%%%%%%%%%");
    mvprintw(16, 20, "#%%%%%%%%%%#############%%%%%%%%%%%%%%##%%%#+*#####%%%%%##%%%%%#*%%%%%%%%%%%%%%#%");
    mvprintw(17, 20, "%%%%%%%%%%%%%%%%%#*###%####*%%%%%%%%%%%%%%%%%%#%%%#%%%%%%%%%##%%%%%%%%%%%%%%%%%#%%");
    mvprintw(18, 20, "%%%%%%%%%%%%%%%%%%###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#%%%%%%%%%%%%%%%%%%%%%");
    mvprintw(19, 20, "@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@%%%%%%%%%%##%%%%%#%%%%%%%#%#%");
    mvprintw(20, 20, "@@@@@%%%%%%%%%%%%%%%%%@@%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@%%%%%%%%%#*****%#%##%%%%%%%%");
    mvprintw(21, 20, "@@@@@@@%%%%%%%%%%%%%%@%@@@@@%%%%%%%%%%%%%%%%%@%@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%");
    mvprintw(22, 20, "@@%%%%%%@@@@@%%%%%%@@@@@@@@@@@%%%%%%%%%%@%%%%@@@@@@@@@@@@@@@%%%%%%%%%%%%%%@@@%%%@@@");
    mvprintw(23, 20, "@@@@@@%@@%%@@@@@%%@@@@%@@@@@@@@@@%%%%%@@%%%%%%%%@@@%%@@@@%%%%%%%%%###%%%@@@@@@@@@@%");
    mvprintw(24, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@@@@@@@@@%%%%%%%%%@%%%%%%#%#%%%%%#%@@@@@@@@@%");
    mvprintw(26, 22, "El instinto te guía a las entrañas de la nave. Un lugar húmedo y cálido cerca del reactor.");
    mvprintw(27, 19, "Comienzas a segregar una resina orgánica, transformando el metal frío en un nido viviente.");
    mvprintw(28, 31, "Pronto, la colmena tendrá un nuevo hogar. El nido está casi completo.");
    esperarEnter(33);

    limpiarYDibujarMarco();
    mvprintw(2, 20, "@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@");
    mvprintw(3, 20, "%%%%%#################*+#%##***#%@@@@@%%%#*#**********+*++##:+*****+*+*+++++%+:***");
    mvprintw(4, 20, "%%%%##################*+%@@@*#**+@@%@%#%#**%@@@%%###%%%%+++***++*#*#+++++++++=-++===");
    mvprintw(5, 20, "%#######*############*****+##***@****@@@%++#%@%+#%###@#*%@%%%#*==++=*#*+-**++===++==");
    mvprintw(6, 20, "###*****************%#******************+*#%#*%*@@@##%##+=*%#%%**+%*+===*%+#+==++*+*");
    mvprintw(7, 20, "****++***************#%@@@%*+***++++**+*#@%#%=#%@%%*#=*-===*%#*#*#*+==+*#**==+==-=--");
    mvprintw(8, 20, "**++=+++++++++++++%%#*#%@%*+++++++%#*++++#%++++*%%=-=#@#**=====##**==+*+-=+*#*+=-:::");
    mvprintw(9, 20, "*+++===-+===++++==*##*%@%#=:+@%@%=+++==----+*:-:-+*++*-%@@@@@*-==--::+=======-+=-=#+*");
    mvprintw(10, 20, "+++==============*#**@%*%%*=-+*@#+=======+#=#@%#+=++%%%@@@@#*-:-+#+:---==-----::.-**=");
    mvprintw(11, 20, "*==-----===-----=**@#@@*++#%@%#@%+-------#+=#%@@=---@@@@@@@#%%+=#%*-:------::::..:+*#");
    mvprintw(12, 20, "=-------+:::::::-#%%%@@@%#%%@@@@%#+-::--=--#%@%#+*+*=::::==+*%@*%#+#+=-------::::....");
    mvprintw(13, 20, "=-----#%#*+=:..:=#@#@@@@@@@@@@@%%%*=::::::+@%+#+*=:-======:--=+#%+++=------::::.....");
    mvprintw(14, 20, "-::::+%%#**:..:+%%#%%@@@%%%%%@#+%@#+-::--+@%*###*+--=*++=-::-:=+***###*+-:::::.....");
    mvprintw(15, 20, "*+-*#@%#-..:+#%%@###%@%==%@*#%%=+*%@%*++*++%###%#*=::+#@%#+**++------=+=+*=::::....");
    mvprintw(16, 20, "%%#%%%%@#+-..:+@%#*+@@@%*=@@@@@%=+#%#==+*#*+:.:+%#*+=::--+#%%%####*-+:::-==*+:::::..");
    mvprintw(17, 20, "=##%%%#*+#%#=::-#%@@%%*=+##**#*+-...........:*%*+==------:+%%%%%%@@@%@@@#%+*+=+##");
    mvprintw(18, 20, "*##%####+:...:-=+**#%@%=-:--=#+*#*-..:::::::=%%+-:------*+##%%%#%%@@@%@@@@@%%%%#+-");
    mvprintw(19, 20, "-=:............==+#*=+##%@%*==###*::---+%@#*+=----*#%%#**+==*#+-::::::-----------");
    mvprintw(20, 20, "...................-+***+###%@@*=+##+====*#%*#*=---+#%%%%**==**=--------======----");
    mvprintw(21, 20, "::...............:+++==*#####%%#**#*@@%%*=+++####+--#%%%%#**+==+=++++++++++=========");
    mvprintw(26, 36, "Solo queda una. La más fuerte. La más resistente. Ripley.");
    mvprintw(27, 21, "Sirenas rojas parpadean. Ha activado la autodestrucción de la nave. Quiere aniquilarte.");
    mvprintw(28, 22, "La encuentras en su camino a la cápsula de escape. Es hora de terminar la cacería.");
    esperarEnter(33);

    bool ganoBatalla = iniciarBatalla();

    if (ganoBatalla) {
        limpiarYDibujarMarco();
        mvprintw(2, 20, "%%##***+++===================++***##*****########%%%@@@%%%##*#%%%%%%@@@@@@@@@@@@@@");
        mvprintw(3, 20, "%%##**++=====-=--====-========+*********#*##%#%@#%%%%##%#%#%%%%%@%%%@@@@@@@@%@@@@@");
        mvprintw(4, 20, "%%##**++====--------=-=======++***##*#****#%%@@%%%*%@%%***##%%@@%%@@@@@@@@@@%@@@%@");
        mvprintw(5, 20, "@%%#*+++===--------====---==++**#######%%%%@%##*%@@%*#%%%%@%@@@@@@@@@@@@@@@@%@@@@@");
        mvprintw(6, 20, "@%%#*++++==----------------==+**######%@@%@**#%%%#*#%%%@@@@@@@@@@@@@@@@@@@%@%@@@@@");
        mvprintw(7, 20, "@%##**+++==-------------==+**+*#*####%@@@%%#%%%@%%@@@@@@@@@@@@@@@@%@@@@@@@%%%@@@@@");
        mvprintw(8, 20, "@%##**+++===--------::------=*#%####%@@@%%%%#%%@@@@%@@@@@@@@@@@@@@@@@@@@@%%%@@@@@@");
        mvprintw(9, 20, "@%##****+++++####*--=+-:..::-+++%%#@@%@#@@@@@@@@%@@@@@@@@@@@@@@@@@%@@@@@%@@@@@@@%@");
        mvprintw(10, 20, "@%%#*=*+-*-+##%###%%%%###%+==*+**%@%%@@%%@@@@%@@%@@@@@@@@@@@@@@@@@@@@@@%@@@@@@%@@@");
        mvprintw(11, 20, "@%%*+**+#=+***##%#******%%%++#%+*#%%%%###%%%@@@@@@@@@@%@%%%@@@@@@%#@@@@@@%@@@@@@%@");
        mvprintw(12, 20, "@@@##%@%#++#%%#%==-=****#*#*%%%++**#######%%##%#%#%@@@@@@@@@@@@@%%@@@@@@%@@@@@@%@@");
        mvprintw(13, 20, "@@@@#%@%@%@%@@@@#+++*%%+-:==*%#*===+*#**#######%%@%%%@@@@@@@@@@@%@@@@@@%@@@@@@%@@@");
        mvprintw(14, 20, "@@@@%*##+*#*%#%%#+%%%%%##+:--*#*#+=-++**##****####%%%%%%%@@@@@@%@@@@%%@@@@@@%##@@@");
        mvprintw(15, 20, "@@@@@**++=*@######++**-==*%++-:++****+##%@%%%%%%##%%@%###%**@@@%@@@@%#%#%##*#%%@@@");
        mvprintw(16, 20, "@@@@@@@@@@@%%-*****=+=----**%+==+-=*#%%+==**+=#%##*#%@@@@@%#@@%@@@@@%@@%%@%@@@@@@@");
        mvprintw(17, 20, "@@@@@@@@@@@@%**+#*%*+=::-:-===*#++--+---=-=***#++=*%%@@@@%#%@#%@@@@@@@@@@@@@@@@@@@");
        mvprintw(18, 20, "@@@@@@@@%@@@%*#=+#*%%+++::.-:--+#%##%*####%%%@@%%%#%%@%##%@@#%@@@@@%%@@@@%@@@@@@@@");
        mvprintw(19, 20, "%@@@@@@@@@%@@@@@#*+++%#%%#*++*+:=++*#@%@@@@@@%%@%%%%%@@@%***@@@@@@%#@@@@@@@@@@@%%*");
        mvprintw(20, 20, "%%%%%@@@@@%@@@@@@@@%%===*%##%##%######*@@@%#**@#%%%@@@@@%%##%#*##@@@@@@%%##*+++=*");
        mvprintw(21, 20, "@%%%@@@@@@@@%@@@@@@@@%%++**%**#@@@@%%**@%%#%*#@%%@@@@@@@@@@%@@@@@@@@@@@@@@@%%%%%@");
        mvprintw(22, 20, "%@%@@@@@@@@@@@%@@@@@@@@%*+-++%%%*+**##*@@*=##*@%#*+*##@@@@@@@@@@@@%%%###%%###%%%%");
        mvprintw(23, 20, "@@@@@@@%@@@@@@%%%@@@@@@#=-+%%*#%%%@@%##@@@%%##@@%%#*##%%***+*#%%%%%%%%@@@@@@@@@@@");
        mvprintw(24, 20, "%@@@@@%%@@@@@@%%%%%@@#==+#%%%%@%%#%%%%%@@@#%%#@@@%%%**+*#+==+**+****##%@@@@@@@%#+");
        mvprintw(27, 20, "Ripley yace derrotada. Su voluntad se quebró, pero su cuerpo servirá a un propósito mayor.");
        mvprintw(28, 21, "La arrastras hacia el nido mientras la nave se desintegra a tu alrededor.");
        esperarEnter(33);

        limpiarYDibujarMarco();
        mvprintw(2, 20, "                                     _--_-_--_-_--_-_");
        mvprintw(3, 20, "                               _--_-_--_-_--_-_--_-_--_-");
        mvprintw(4, 20, "                           _--_-_--_-_--_-_--_-_--_-_--_-_");
        mvprintw(5, 20, "                       _--_-_--_-_--_@*#%%#%#%#++%@-_--_-_--");
        mvprintw(6, 20, "                   _--_-_--_-_--_@%*-+%@@@++*%@#-@%@-_--_-_--_-_");
        mvprintw(7, 20, "                _--_-_--_-_--_@++-%%@@#=##*@#+%%%%@-_--_-_--_-_--");
        mvprintw(8, 20, "              _--_-_--_-_--_@===@@@%**@##%@@@@@%@-_--_-_--_-_--");
        mvprintw(9, 20, "            _--_-_--_-_--_@=-*@@#*@*#%%@*%@@@@@-_--_-_--_-_--");
        mvprintw(10, 20, "          _--_-_--_-_--_@=:#%@****%#@%#%#@@@@@-_--_-_--_-_--");
        mvprintw(11, 20, "         _-_--_-_--_@%*-:=#-%%#**+*%#@@@@*%@@@@@-_--_-_--");
        mvprintw(12, 20, "        _-_--_-_--_@*##+*@@=*+-=====*@@@@@@@@@@@-_--_-_");
        mvprintw(13, 20, "       -_--_-_--_@#+%*+@%-+++#=-+*=@@%@@@@@@@@-_--_-_");
        mvprintw(14, 20, "      -_--_-_--@*+#####%##%@%%@@%%#@@@@@@@@@-_--_-_");
        mvprintw(15, 20, "     -_--_-_--@%%######%@@%@@@%#**%#%@#*@-_--");
        mvprintw(16, 20, "    _--_-_--_@%@@@@@#+#@@@@@@@@*++*#@@@@@*==*");
        mvprintw(17, 20, "   _--_-_--_@%@@@@@@@@%*+*#%@@@@@@@%#%@@@@@%");
        mvprintw(18, 20, "   -_--_-_--_@@@@@@@@@@@@%#%@@@@@@@@@@@@@@@");
        mvprintw(19, 20, "   -_--_-_--_-_--_@@@@@@@@@@@@@@@@@@@@@-_");
        mvprintw(20, 20, "    _--_-_--_-_--_-_--_-_--_-_--_-_--_");
        mvprintw(21, 20, "      -_--_-_--_-_--_-_--_-_--_-_");
        mvprintw(22, 20, "        -_--_-_--_-_--_-_--_-");
        mvprintw(23, 20, "          -_--_-_--_-_--");
        mvprintw(27, 21, "Escapas en la cápsula de escape. La presa final está asegurada. El futuro de la colmena viaja");
        mvprintw(28, 20, "contigo, dormido, esperando un nuevo mundo que conquistar.");
        mvprintw(30, 43, "¡GANASTE! LA COLMENA SOBREVIVIRA.");
        esperarEnter(33);
    } else {
        limpiarYDibujarMarco();
        mvprintw(2, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(3, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(4, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(5, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(6, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(7, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(8, 20, "@@@@@@@@@@@@@@@@@@@@@*-====+%%@%%#-=-+%%@@*--%%@%%+-=%%*--======%%@@@@@@@@@@@@@@@@@@");
        mvprintw(9, 20, "@@@@@@@@@@@@@@@@@@@+==#@@@%%@@+==#%#+-+%%*--===--=%%*--%%@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(10, 20, "@@@@@@@@@@@@@@@@@@@=-+@@+=-+%%+-=***-=%*--%%+**-=%*--+++++@@@@@@@@@@@@@@@@@@@@");
        mvprintw(11, 20, "@@@@@@@@@@@@@@@@@@@#+-=%@*-+%%+-=*##+-=%%*--@%%%%*-=%%*--@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(12, 20, "@@@@@@@@@@@@@@@@@@@@@@#+++++*@*++@@@#+*%%#++@@@#++%%#++++++++%%@@@@@@@@@@@@@@@@@@@@");
        mvprintw(13, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(14, 20, "@@@@@@@@@@@@@@@@@@@@#+++++#@@*+*@@@#**@#********%%%%*******@@@@@@@@@@@@@@@@@@@@");
        mvprintw(15, 20, "@@@@@@@@@@@@@@@@@@@+-=###+-+%%+-=@@@*-=%%*--######@*--###*-=%%@@@@@@@@@@@@@@@@@@@");
        mvprintw(16, 20, "@@@@@@@@@@@@@@@@@@@=-+@@@*-+%%+--*%%*=-=%%*--++++*@@*--@@#=--%%@@@@@@@@@@@@@@@@@@@");
        mvprintw(17, 20, "@@@@@@@@@@@@@@@@@@@=-+@@@*-+%%%%*=---=+%@*--%%%%%%%@@*--=--=*%%@@@@@@@@@@@@@@@@@@@");
        mvprintw(18, 20, "@@@@@@@@@@@@@@@@@@@*+=+++==*@@@%%+=+#@@@*--++++++%%*--@#=--+%%@@@@@@@@@@@@@@@@@@@");
        mvprintw(19, 20, "@@@@@@@@@@@@@@@@@@@@@%%%%%%@@@@@@%%@@@@@@%%%%%%%%@@%%%%@@@%%%@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(20, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(21, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(22, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(23, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(24, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(25, 20, "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
        mvprintw(27, 24, "La humana es más astuta de lo que parecía. Con un último acto de desesperación,");
        mvprintw(28, 22, "abre la compuerta exterior y te expulsa al vacío helado del espacio.");
        mvprintw(29, 22, "Flotas a la deriva, congelándote en la oscuridad infinita. Tu cacería ha terminado.");
        esperarEnter(33);
    }
}

bool iniciarBatalla() {
    Personaje jugador("Xenomorfo", 300, 22, 5);
    Personaje enemigo("Ripley", 250, 18, 8);
    
    vector<string> logDeBatalla;
    logDeBatalla.push_back("¡El Xenomorfo se interpone en el camino de Ripley!");
    
    while (jugador.estaVivo() && enemigo.estaVivo()) {
        limpiarYDibujarMarco();
        mvprintw(1, 40, "[ BATALLA FINAL ]");
        jugador.mostrarEstado(3, 4);
        enemigo.mostrarEstado(4, 4);
        mostrarLog(logDeBatalla);
        mvprintw(15, 4, "¡Tu turno! Elige un ataque:");
        mvprintw(16, 4, "1. Garras (Rápido, daño bajo)");
        mvprintw(17, 4, "2. Cola (Normal, daño medio)");
        mvprintw(18, 4, "3. Mordida (Poderoso, puede fallar)");
        mvprintw(20, 4, "Selecciona una opción: ");
        refresh();

        char ch;
        int eleccion = 0;
        while( (ch = getch()) ) {
            if (ch >= '1' && ch <= '3') {
                eleccion = ch - '0';
                break;
            }
        }

        switch (eleccion) {
            case 1: jugador.atacarConGarras(enemigo, logDeBatalla); break;
            case 2: jugador.atacarConCola(enemigo, logDeBatalla); break;
            case 3: jugador.atacarConMordida(enemigo, logDeBatalla); break;
        }

        if (!enemigo.estaVivo()) break;

        logDeBatalla.push_back("¡Ripley contraataca con su lanzallamas!");
        enemigo.ataqueEnemigo(jugador, logDeBatalla);
    }

    limpiarYDibujarMarco();
    mvprintw(1, 40, "[ FIN DE LA BATALLA ]");
    mostrarLog(logDeBatalla);
    
    if (jugador.estaVivo()) {
        mvprintw(12, 4, "¡VICTORIA! ¡Has derrotado a Ripley!");
    } else {
        mvprintw(12, 4, "¡DERROTA! Ripley te ha vencido.");
    }
    esperarEnter(14);
    return jugador.estaVivo();
}

void mostrarLog(const vector<string> &log) {
    mvprintw(7, 4, "--- Registro de Batalla ---");
    int inicio = log.size() > 4 ? log.size() - 4 : 0;
    int linea = 8;
    for (size_t i = inicio; i < log.size(); ++i) {
        mvprintw(linea, 4, "- %s", log[i].c_str());
        linea++;
    }
    mvprintw(linea, 4, "---------------------------");
}